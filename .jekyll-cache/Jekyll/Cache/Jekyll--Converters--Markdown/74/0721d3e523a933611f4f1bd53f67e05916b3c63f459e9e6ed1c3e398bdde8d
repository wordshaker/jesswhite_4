I"π%<hr />
<center>
<h3> A Practical Guide To Dashboarding Part Two </h3>
</center>

<hr />
<p><br /></p>

<p>As mentioned in the <a href="https://jesswhite.co.uk/2019/04/15/practicaldashboardspart1-post.html">previous post</a> having baselines for dashboards can be useful for a variety of reasons.</p>

<ul>
  <li>Recognising patterns for where to investigate when something goes wrong in your system.</li>
  <li>Transferrable knowledge across teams.</li>
</ul>

<p>In this post, we shall explore how this applies to metrics measuring the health of a service.</p>

<h2 id="use">U.S.E</h2>
<hr />

<p>There is a pattern proposed by <a href="http://www.brendangregg.com/">Brendan Gregg</a> called <a href="http:/www.brendangregg.com/usemethod.html">U.S.E</a> used for <em>‚Äúanalysing the performance of any system.‚Äù</em> This particular blog post had more of an ‚Äúoperational‚Äù focus. He refers often to ‚Äúresource‚Äù which is referring to <em>‚Äúall physical server functional components (CPUs, disks, busses, ‚Ä¶)‚Äù</em></p>

<p>Brendan Greggs pattern can be slightly adjusted to be great for measuring the ‚Äúhealth‚Äù of services.</p>

<p>The acronym U.S.E, in this case, stands for Utilisation, Saturation and Error. I‚Äôve used this pattern in a couple of the places I‚Äôve worked in and it‚Äôs avoided catastrophe.</p>

<h3 id="utilisation">Utilisation</h3>

<p>In Brendan Gregg‚Äôs original definition he describes utilisation as <em>‚Äúthe average time that the resource was busy servicing work‚Äù</em>.</p>

<p>When applying this to our definition for analysing services, this refers to how long a service takes to do it‚Äôs process, the work it needs to do. It‚Äôs the time from input to outcome.</p>

<div style="text-align:center; width:70%; margin-left: 10%;">
  <p><img src="/assets/img/2019-06-15/utilisation.png" alt="Layers" /></p>
</div>

<hr />
<p><em>Analogy: a person clocking in and out of work. The time from when they clock in, to after they‚Äôve done their work and clocked out.</em></p>

<hr />

<p>This information tells us how long it is taking to process the work.</p>

<p>This may align to key performance indicators (KPI‚Äôs) relating to the service or whether this is having a detrimental effect on service level agreements (SLA‚Äôs). This metric can indicate where work might need to be done to address issues in the system. For example, it might be an API is slow in responding, but that is due to the downstream effects of this service taking a long time to do it‚Äôs job.</p>

<p>By itself, this metric is useful. In combination with saturation and error, it becomes even more valuable.</p>

<h3 id="saturation">Saturation</h3>

<p>In Brendan Gregg‚Äôs original definition he describes saturation as: <em>‚Äúthe degree to which the resource has extra work which it can‚Äôt service, often queued‚Äù</em>.</p>

<p>This is where the definitions I use for service metrics diverges a bit. Here I use saturation to describe the degree to which work is queued, without considering resource.</p>

<p>This could be in a literal queue in the case of services - RabbitMQ, SQS or similar. There a couple of measures for this - the depth of queue, and the oldest message.</p>

<div style="text-align:center; width:70%; margin-left: 10%;">
  <p><img src="/assets/img/2019-06-15/saturation.png" alt="Layers" /></p>
</div>

<hr />
<p><em>Analogy: When a toilet is occupied it can‚Äôt take on any more ‚Äúwork‚Äù. As such the queue gets longer outside. The degree to which the ‚Äútoilet service‚Äù is saturated is the degree to which that queue builds up.</em></p>

<hr />

<p>If the work being into your service is building up, there are a couple of problems that could be happening. It might be that your service cannot cope with the load and needs to be scaled. It might be that a change to the service has increased the utilisation time (see above) which has meant it can‚Äôt process the work as quickly.</p>

<p>As you have both utilisation and saturation metrics, you can use these to determine where you need to focus your diagnostic efforts in fixing the issues or improving the performance of your system.</p>

<h3 id="error">Error</h3>

<p>In Brendan Gregg‚Äôs original definition he describes saturation as: <em>‚Äúthe count of error events‚Äù</em>.</p>

<p>For monitoring services, errors are pretty much what you would expect. When measuring errors, you need to consider the different types of errors (high level errors, internal errors, custom errors) the levels of error (fatal - warning) and the effect of these errors.</p>

<p>Without causing too much noise we need to measure these errors in a suitable way. If it is a fatal error, don‚Äôt just show it on a dashboard - alert on it. It needs an immediate response.</p>

<div style="text-align:center; width:70%; margin-left: 10%;">
  <p><img src="/assets/img/2019-06-15/error.png" alt="Layers" /></p>
</div>

<hr />
<p><em>Analogy: Well‚Ä¶ there‚Äôs no need for an analogy here‚Ä¶</em></p>

<hr />

<p>For trying to determine if an error should be shown on a dashboard, I normally ask myself the following:</p>

<ul>
  <li>
    <p>Can I stop this error from happening/being a problem?</p>
  </li>
  <li>
    <p>Do I need to know if this error is aggregating/building up over a certain threshold over time?</p>
  </li>
  <li>
    <p>Is this an internal error that may have an effect on the other two measurements, thereby providing context to where they are effected?</p>
  </li>
  <li>
    <p>Is it a ‚Äúdiagnostic‚Äù error? If I can see something is going wrong at a higher level, it can probably be logged instead.</p>
  </li>
</ul>

<p>By addressing if the error should be shown on a dashboard, or should be visible through a different means of monitoring, I prevent my dashboards from being over crowded with information.</p>

<h4 id="errors-arent-just-technical">Errors aren‚Äôt just technical</h4>

<p>Harking back at my previous posts - there aren‚Äôt just technical errors but also business concerns contextual to the service. The service is built for some business need and there may be behaviour which technically works, but is not desired behaviour for the businesses needs. These should be measured as well.</p>

<p>In the case of errors showing detriment to business requirement, these should be shown on the dashboard, and depending on effect, maybe should be alerted on.</p>

<h2 id="using-these-in-combination">Using these in combination</h2>
<hr />

<p>Together, these metrics are incredibly powerful.</p>

<p><em>Examples:</em></p>

<p>A slower utilisation and a higher saturation could point to a couple of causes. Maybe we have an increased load to our application and the service can‚Äôt cope with it. It might be that we need to scale or look into how we can improve the performance of the system. We would have to find out if there was an event that might have lead to this increase and if a short or long term fix would be required.</p>

<p>Another cause could just be the service is having issues. We should be able to see this from an increase in errors.</p>

<p>It might be that utilisation is still good but the saturation has increased. Here, we would scale as the problem doesn‚Äôt seem to be with the service itself, especially if there isn‚Äôt an increase in errors, and do some further investigations.</p>

<p>There are more combinations than those listed here, but over time you learn the patterns of unusual behaviour in your system and how to react. All from less than 5 baseline metrics.</p>

<h2 id="caveat">Caveat</h2>
<hr />

<p>I‚Äôve found these particular metrics very useful. Using them across teams as a general baseline makes it easier to move from one team to another and understand the state of their systems.</p>

<p>If these metrics aren‚Äôt already in place or if the information isn‚Äôt available, it can take a lot of time and effort to put in place. Needless to say, I think measuring metrics on visual dashboards alongside other forms of monitoring (alerts, diagnostics etc.) is an effective way of knowing the state of your systems and driving down the time to detect and respond to problems in them.</p>

<p>The introduction of working in this way without having the telemetry (measurements) in place is tricky in itself before taking into account the cultural change. For this to be effective you have to have the investment from your team, and preferably the company as a whole.</p>

<h2 id="coming-next">Coming next‚Ä¶</h2>
<hr />

<p>The next post will contain proposals for baselines for measuring API‚Äôs.</p>

<hr />

<p><em>Chapter 2 - A Practical Guide To Dashboarding Series</em></p>

<ul>
  <li>
    <p><a href="/2019/04/15/practicaldashboardspart1-post.html">Part 1 - Introduction To Baselines for Dashboards</a></p>
  </li>
  <li>
    <p><strong><a href="/2019/06/15/practicaldashboardspart2-post.html">Part 2 - Baselines for Services. </a></strong></p>
  </li>
  <li>
    <p><a href="/2019/08/31/practicaldashboardspart3-post.html">Part 3 - Baselines for API‚Äôs.</a></p>
  </li>
</ul>

<hr />

<p><em>Chapter 1 - Creating &amp; Maintaining Impactful Dashboards Series</em></p>

<ul>
  <li>
    <p><a href="/2018/04/09/impactfuldashboardspart1-post.html">Part 1 - Creation of impactful dashboards</a></p>
  </li>
  <li>
    <p><a href="/2018/04/22/impactfuldashboardspart2-post.html">Part 2 - Continuous Maintenance.</a></p>
  </li>
  <li>
    <p><a href="/2018/04/23/impactfuldashboardspart3-post.html">Part 3 - Danger Signs and Don‚Äôts.</a></p>
  </li>
</ul>

<hr />

<div style="text-align:center; width:20%; margin-left: 10%;">
  <p><img src="/assets/img/logo.png" alt="Logo" /></p>
</div>
:ET